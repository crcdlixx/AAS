PORT=5174
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o
OPENAI_MAX_TOKENS=

# 自定义 API：可选模型列表（逗号分隔）。用于前端“自定义 API”里下拉选择模型。
# 留空则从 OPENAI_MODEL / ROUTER_MODEL / MODEL1/2_NAME / ROUTE_* 等配置里自动汇总。
# Optional: model list for the frontend "Custom API" dropdown (comma-separated).
# DEPRECATED: AAS_MODEL_LIST
# The server now fetches the model list from the configured API (`GET /v1/models`), including Custom API overrides.
AAS_MODEL_LIST=

# MCP（理科调用工具）
MCP_PYTHON_ENABLED=1
MCP_PYTHON_URL=http://127.0.0.1:8080/method/execute_python
MCP_PYTHON_TIMEOUT_MS=120000

# PDF 解析（知识库上传 PDF 时可能触发图片回退 OCR）
# 图片回退每页都会调用一次视觉模型，建议限制页数避免成本/耗时失控。
PDF_IMAGE_FALLBACK_MAX_PAGES=6

# 知识库（按浏览器指纹会话，默认仅内存保存）
KB_MAX_FILES=20
KB_MAX_TOTAL_BYTES=52428800

# 知识库 RAG（检索增强）
# - 上传时会分块；解题/追问时按题目检索相关块并让模型“基于参考资料校对补充”。
# - 默认使用 OpenAI embeddings（若 embeddings 不可用会自动降级为关键词检索）。
KB_RAG_ENABLED=1
KB_CHUNK_TOKENS=500
KB_CHUNK_OVERLAP_TOKENS=80
KB_TOP_K=8
KB_EMBEDDING_MODEL=text-embedding-3-small
KB_EMBEDDING_BATCH_SIZE=64

# 路由模型（可选）：用于“自动路由”模式判断文科/理科
# 留空则默认复用 OPENAI_API_KEY / OPENAI_BASE_URL
# Subject (humanities/science)
# The UI now sends `subject` per page. If `subject` is NOT provided by the client,
# the server falls back to this router model to auto-classify humanities/science.
# Leave empty to reuse OPENAI_API_KEY / OPENAI_BASE_URL.
ROUTER_MODEL=gpt-4o-mini
ROUTER_API_KEY=
ROUTER_BASE_URL=

# 自动路由策略
# - 文科默认单模型，理科默认双模型审查（可自行调整）
# Policy when `mode=auto` (per question)
# - humanities defaults to single, science defaults to debate (tweak as needed)
ROUTE_HUMANITIES_MODE=single
ROUTE_SCIENCE_MODE=debate
ROUTE_DEFAULT_MODE=debate
ROUTE_UNKNOWN_MODE=

# 自动路由下：单模型模型列表（逗号分隔，取第一个；未配置则使用 OPENAI_MODEL；若请求里带 X-AAS-Model，则以请求为准）
ROUTE_HUMANITIES_SINGLE_MODELS=
ROUTE_SCIENCE_SINGLE_MODELS=
ROUTE_UNKNOWN_SINGLE_MODELS=

# 兼容旧写法（等价于 *_SINGLE_MODELS 只有 1 个）
ROUTE_HUMANITIES_MODEL=
ROUTE_SCIENCE_MODEL=
ROUTE_UNKNOWN_MODEL=

# 自动路由下：双模型审查模型列表（逗号分隔，对应模型1、模型2；未配置则使用下方 MODEL1/2_*）
ROUTE_HUMANITIES_DEBATE_MODELS=
ROUTE_SCIENCE_DEBATE_MODELS=
ROUTE_UNKNOWN_DEBATE_MODELS=

# 自动路由下：双模型审查可按学科覆盖模型1/2的名称/Key/BaseURL（优先级低于请求头 X-AAS-* 覆盖）
ROUTE_HUMANITIES_DEBATE_MODEL1_NAME=
ROUTE_HUMANITIES_DEBATE_MODEL1_API_KEY=
ROUTE_HUMANITIES_DEBATE_MODEL1_BASE_URL=
ROUTE_HUMANITIES_DEBATE_MODEL2_NAME=
ROUTE_HUMANITIES_DEBATE_MODEL2_API_KEY=
ROUTE_HUMANITIES_DEBATE_MODEL2_BASE_URL=

ROUTE_SCIENCE_DEBATE_MODEL1_NAME=
ROUTE_SCIENCE_DEBATE_MODEL1_API_KEY=
ROUTE_SCIENCE_DEBATE_MODEL1_BASE_URL=
ROUTE_SCIENCE_DEBATE_MODEL2_NAME=
ROUTE_SCIENCE_DEBATE_MODEL2_API_KEY=
ROUTE_SCIENCE_DEBATE_MODEL2_BASE_URL=

ROUTE_UNKNOWN_DEBATE_MODEL1_NAME=
ROUTE_UNKNOWN_DEBATE_MODEL1_API_KEY=
ROUTE_UNKNOWN_DEBATE_MODEL1_BASE_URL=
ROUTE_UNKNOWN_DEBATE_MODEL2_NAME=
ROUTE_UNKNOWN_DEBATE_MODEL2_API_KEY=
ROUTE_UNKNOWN_DEBATE_MODEL2_BASE_URL=

# 双模型审查配置（可选，供自动路由在需要时使用）
MODEL1_NAME=gpt-4o-mini
MODEL1_API_KEY=your_model1_api_key_here
MODEL1_BASE_URL=https://api.openai.com/v1

MODEL2_NAME=gpt-4o
MODEL2_API_KEY=your_model2_api_key_here
MODEL2_BASE_URL=https://api.openai.com/v1

# 审查迭代次数
MAX_DEBATE_ITERATIONS=3

# 用量控制（按浏览器指纹 X-AAS-Fingerprint）
# 每 windowHours 小时最多使用 limitTokens token（留空则不限制）
USAGE_LIMIT_TOKENS=
USAGE_LIMIT_WINDOW_HOURS=24
